# CL_milestone_implement

This is Pytorch implementation of the Prompt-based Continual Learning with [pytorch-template](https://github.com/victoresque/pytorch-template) in the following milestone papers:

- [L2P] A Baseline for Detecting Missclassified and Out-of-Distribution Examples in Neural Networks | **[CVPR2022]** [[paper]](https://arxiv.org/abs/2112.08654.pdf)
- [DualPrompt] DualPrompt: Complementary Prompting for Rehearsal-free Continual Learning | **[ECCV2022]** [[paper]](https://arxiv.org/abs/2204.04799)

## Installation & requirement

The current version of the code has been tested with `python 3.8.0` on an Ubuntu 18.04 OS with the following versions of Pytorch, Torchvision and timm:

- `pytorch 1.12.0`
- `torchvision 0.13.0`
- `timm 0.6.7`

Further Python-packages used are listed in `requirements.txt`.
Assuming Python and pip are set up, these packages can be installed using:
```bash
pip install -r requirements.txt
```

## Folder Structure
```angular2html
CL_milestone_implement/
│
├── L2P/ - L2P implementation proj
│   └── data_loader/ - CIFAR100 and 5-dataset loader
│   └── model/ - backbone (ViT) + prompt src
│   └── output/ - checkpoint dir
│   └── trainer/ - Train core src
│   └── utils/ 
│   └── parse_config.py - parser
│   └── train.py - main src
├── DualPrompt/ - DualPrompt implementation proj
├── ViT/ - ViT implementation proj
├── license
├── requirements.txt
└── train.py - **main script to start training**
```

## Running custom experiments
### 1. L2P
**How to run?**

(1) If you want to full-train
```train
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch \
        --nproc_per_node=[Node num] \
        --use_env train.py \
        cifar100_l2p \
        --model vit_base_patch16_224 \
        --batch-size [Batch size] \
        --tensorboard True \
```
(2) If you want to evaluate
```eval
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch --nproc_per_node=[Node num] --use_env train.py cifar100_l2p --checkpoint_dir checkpoint --eval
```

### 2. DualPrompt
**How to run?**

(1) If you want to full-train
```train
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch \
        --nproc_per_node=[Node num] \
        --use_env train.py \
        cifar100_dualprompt \
        --model vit_base_patch16_224 \
        --batch-size [Batch size] \
        --tensorboard True \
```
(2) If you want to evaluate
```eval
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch --nproc_per_node=[Node num] --use_env train.py cifar100_dualprompt --checkpoint_dir checkpoint --eval
```

**Result**

(1) CIFAR100
```result
Loading checkpoint from: output/checkpoint/task1_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:07<00:00,  7.97it/s]
Task ID : 1, Val loss : 0.260, ACC@1 : 97.400, ACC@5 : 99.900
--------------------------------------------------------------------------------
Task ID : 1, AVG ACC 1 : 97.400, AVG ACC 5 : 99.900
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task2_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.73it/s]
Task ID : 1, Val loss : 0.311, ACC@1 : 94.600, ACC@5 : 99.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.65it/s]
Task ID : 2, Val loss : 0.401, ACC@1 : 94.400, ACC@5 : 99.400
--------------------------------------------------------------------------------
Task ID : 2, AVG ACC 1 : 94.500, AVG ACC 5 : 99.650
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task3_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.61it/s]
Task ID : 1, Val loss : 0.369, ACC@1 : 90.900, ACC@5 : 99.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.63it/s]
Task ID : 2, Val loss : 0.440, ACC@1 : 92.500, ACC@5 : 98.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.59it/s]
Task ID : 3, Val loss : 0.356, ACC@1 : 91.700, ACC@5 : 99.500
--------------------------------------------------------------------------------
Task ID : 3, AVG ACC 1 : 91.700, AVG ACC 5 : 99.300
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task4_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.61it/s]
Task ID : 1, Val loss : 0.380, ACC@1 : 90.900, ACC@5 : 99.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.59it/s]
Task ID : 2, Val loss : 0.510, ACC@1 : 88.200, ACC@5 : 98.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.58it/s]
Task ID : 3, Val loss : 0.381, ACC@1 : 91.100, ACC@5 : 99.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.58it/s]
Task ID : 4, Val loss : 0.387, ACC@1 : 92.000, ACC@5 : 98.400
--------------------------------------------------------------------------------
Task ID : 4, AVG ACC 1 : 90.550, AVG ACC 5 : 99.000
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task5_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.57it/s]
Task ID : 1, Val loss : 0.465, ACC@1 : 88.500, ACC@5 : 99.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.55it/s]
Task ID : 2, Val loss : 0.576, ACC@1 : 84.500, ACC@5 : 97.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.60it/s]
Task ID : 3, Val loss : 0.471, ACC@1 : 87.300, ACC@5 : 98.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.62it/s]
Task ID : 4, Val loss : 0.452, ACC@1 : 89.800, ACC@5 : 97.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.52it/s]
Task ID : 5, Val loss : 0.358, ACC@1 : 92.500, ACC@5 : 98.800
--------------------------------------------------------------------------------
Task ID : 5, AVG ACC 1 : 88.520, AVG ACC 5 : 98.400
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task6_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.59it/s]
Task ID : 1, Val loss : 0.499, ACC@1 : 87.500, ACC@5 : 98.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 2, Val loss : 0.588, ACC@1 : 84.400, ACC@5 : 97.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.48it/s]
Task ID : 3, Val loss : 0.519, ACC@1 : 86.800, ACC@5 : 98.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.58it/s]
Task ID : 4, Val loss : 0.513, ACC@1 : 88.600, ACC@5 : 97.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.52it/s]
Task ID : 5, Val loss : 0.399, ACC@1 : 91.900, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.60it/s]
Task ID : 6, Val loss : 0.493, ACC@1 : 84.300, ACC@5 : 99.100
--------------------------------------------------------------------------------
Task ID : 6, AVG ACC 1 : 87.250, AVG ACC 5 : 98.233
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task7_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.58it/s]
Task ID : 1, Val loss : 0.510, ACC@1 : 86.600, ACC@5 : 98.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.50it/s]
Task ID : 2, Val loss : 0.606, ACC@1 : 84.300, ACC@5 : 97.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.50it/s]
Task ID : 3, Val loss : 0.558, ACC@1 : 85.300, ACC@5 : 97.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.52it/s]
Task ID : 4, Val loss : 0.556, ACC@1 : 86.800, ACC@5 : 96.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 5, Val loss : 0.422, ACC@1 : 90.300, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 6, Val loss : 0.521, ACC@1 : 84.300, ACC@5 : 98.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.51it/s]
Task ID : 7, Val loss : 0.490, ACC@1 : 86.800, ACC@5 : 97.900
--------------------------------------------------------------------------------
Task ID : 7, AVG ACC 1 : 86.343, AVG ACC 5 : 97.743
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task8_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.53it/s]
Task ID : 1, Val loss : 0.529, ACC@1 : 85.800, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.54it/s]
Task ID : 2, Val loss : 0.654, ACC@1 : 82.800, ACC@5 : 97.200
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.54it/s]
Task ID : 3, Val loss : 0.574, ACC@1 : 84.500, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.49it/s]
Task ID : 4, Val loss : 0.569, ACC@1 : 86.600, ACC@5 : 96.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.51it/s]
Task ID : 5, Val loss : 0.420, ACC@1 : 90.100, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 6, Val loss : 0.534, ACC@1 : 83.600, ACC@5 : 98.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.52it/s]
Task ID : 7, Val loss : 0.567, ACC@1 : 84.300, ACC@5 : 97.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.59it/s]
Task ID : 8, Val loss : 0.624, ACC@1 : 83.800, ACC@5 : 96.800
--------------------------------------------------------------------------------
Task ID : 8, AVG ACC 1 : 85.188, AVG ACC 5 : 97.575
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task9_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.57it/s]
Task ID : 1, Val loss : 0.584, ACC@1 : 85.400, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.58it/s]
Task ID : 2, Val loss : 0.691, ACC@1 : 82.100, ACC@5 : 96.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.49it/s]
Task ID : 3, Val loss : 0.580, ACC@1 : 84.100, ACC@5 : 97.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 4, Val loss : 0.628, ACC@1 : 85.300, ACC@5 : 96.200
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.47it/s]
Task ID : 5, Val loss : 0.496, ACC@1 : 88.900, ACC@5 : 97.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 6, Val loss : 0.568, ACC@1 : 83.200, ACC@5 : 98.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.52it/s]
Task ID : 7, Val loss : 0.647, ACC@1 : 82.900, ACC@5 : 96.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 8, Val loss : 0.682, ACC@1 : 83.400, ACC@5 : 96.200
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.54it/s]
Task ID : 9, Val loss : 0.362, ACC@1 : 89.100, ACC@5 : 98.800
--------------------------------------------------------------------------------
Task ID : 9, AVG ACC 1 : 84.933, AVG ACC 5 : 97.278
--------------------------------------------------------------------------------

Loading checkpoint from: output/checkpoint/task10_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.56it/s]
Task ID : 1, Val loss : 0.599, ACC@1 : 84.400, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.55it/s]
Task ID : 2, Val loss : 0.689, ACC@1 : 82.100, ACC@5 : 96.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.48it/s]
Task ID : 3, Val loss : 0.580, ACC@1 : 83.500, ACC@5 : 97.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.48it/s]
Task ID : 4, Val loss : 0.625, ACC@1 : 83.800, ACC@5 : 96.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.47it/s]
Task ID : 5, Val loss : 0.525, ACC@1 : 86.100, ACC@5 : 97.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.43it/s]
Task ID : 6, Val loss : 0.557, ACC@1 : 82.700, ACC@5 : 98.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.49it/s]
Task ID : 7, Val loss : 0.656, ACC@1 : 83.000, ACC@5 : 96.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:05<00:00, 10.53it/s]
Task ID : 8, Val loss : 0.679, ACC@1 : 82.600, ACC@5 : 96.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.50it/s]
Task ID : 9, Val loss : 0.432, ACC@1 : 86.800, ACC@5 : 98.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:06<00:00, 10.47it/s]
Task ID : 10, Val loss : 0.424, ACC@1 : 87.800, ACC@5 : 98.800
--------------------------------------------------------------------------------
Task ID : 10, AVG ACC 1 : 84.280, AVG ACC 5 : 97.500
--------------------------------------------------------------------------------

Total AVG ACC 1 : 89.066
Total AVG ACC 5 : 98.458
Total : forgetting : 6.344
 ```

### 2. DualPrompt
**How to run?**

(1) If you want to full-train
```train
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch \
        --nproc_per_node=[Node num] \
        --use_env train.py \
        cifar100_dualprompt \
        --model vit_base_patch16_224 \
        --batch-size [Batch size] \
```
(2) If you want to evaluate
```eval
CUDA_VISIBLE_DEVICES=[GPU idx] python -m torch.distributed.launch --nproc_per_node=[Node num] --use_env train.py cifar100_l2p --checkpoint_dir checkpoint --eval
```

**Result**

(1) CIFAR100
 ```
Loading checkpoint from: ./output/checkpoint/task1_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:07<00:00,  5.84it/s]
Task ID : 1, Val loss : 0.227, ACC@1 : 97.800, ACC@5 : 100.000
--------------------------------------------------------------------------------
Task ID : 1, AVG ACC 1 : 97.800, AVG ACC 5 : 100.000
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task2_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.72it/s]
Task ID : 1, Val loss : 0.273, ACC@1 : 93.900, ACC@5 : 100.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.67it/s]
Task ID : 2, Val loss : 0.380, ACC@1 : 95.200, ACC@5 : 99.200
--------------------------------------------------------------------------------
Task ID : 2, AVG ACC 1 : 94.550, AVG ACC 5 : 99.600
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task3_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.67it/s]
Task ID : 1, Val loss : 0.324, ACC@1 : 91.900, ACC@5 : 99.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 2, Val loss : 0.436, ACC@1 : 93.200, ACC@5 : 98.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.67it/s]
Task ID : 3, Val loss : 0.313, ACC@1 : 93.900, ACC@5 : 99.500
--------------------------------------------------------------------------------
Task ID : 3, AVG ACC 1 : 93.000, AVG ACC 5 : 99.333
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task4_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.66it/s]
Task ID : 1, Val loss : 0.346, ACC@1 : 90.900, ACC@5 : 99.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.68it/s]
Task ID : 2, Val loss : 0.507, ACC@1 : 87.700, ACC@5 : 98.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.65it/s]
Task ID : 3, Val loss : 0.320, ACC@1 : 93.100, ACC@5 : 99.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.68it/s]
Task ID : 4, Val loss : 0.336, ACC@1 : 92.700, ACC@5 : 98.700
--------------------------------------------------------------------------------
Task ID : 4, AVG ACC 1 : 91.100, AVG ACC 5 : 99.000
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task5_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.67it/s]
Task ID : 1, Val loss : 0.373, ACC@1 : 90.200, ACC@5 : 99.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 2, Val loss : 0.568, ACC@1 : 84.500, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.63it/s]
Task ID : 3, Val loss : 0.382, ACC@1 : 90.100, ACC@5 : 99.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 4, Val loss : 0.379, ACC@1 : 91.800, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.64it/s]
Task ID : 5, Val loss : 0.379, ACC@1 : 90.200, ACC@5 : 98.600
--------------------------------------------------------------------------------
Task ID : 5, AVG ACC 1 : 89.360, AVG ACC 5 : 98.660
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task6_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.65it/s]
Task ID : 1, Val loss : 0.449, ACC@1 : 87.700, ACC@5 : 99.200
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.66it/s]
Task ID : 2, Val loss : 0.628, ACC@1 : 83.500, ACC@5 : 97.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.60it/s]
Task ID : 3, Val loss : 0.429, ACC@1 : 88.600, ACC@5 : 98.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 4, Val loss : 0.458, ACC@1 : 89.300, ACC@5 : 97.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 5, Val loss : 0.449, ACC@1 : 88.400, ACC@5 : 98.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.64it/s]
Task ID : 6, Val loss : 0.464, ACC@1 : 84.600, ACC@5 : 98.900
--------------------------------------------------------------------------------
Task ID : 6, AVG ACC 1 : 87.017, AVG ACC 5 : 98.233
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task7_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.65it/s]
Task ID : 1, Val loss : 0.458, ACC@1 : 88.000, ACC@5 : 99.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 2, Val loss : 0.664, ACC@1 : 81.800, ACC@5 : 96.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 3, Val loss : 0.465, ACC@1 : 87.400, ACC@5 : 98.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 4, Val loss : 0.478, ACC@1 : 89.200, ACC@5 : 97.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.60it/s]
Task ID : 5, Val loss : 0.453, ACC@1 : 88.300, ACC@5 : 98.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.60it/s]
Task ID : 6, Val loss : 0.463, ACC@1 : 84.200, ACC@5 : 98.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.58it/s]
Task ID : 7, Val loss : 0.433, ACC@1 : 88.500, ACC@5 : 98.600
--------------------------------------------------------------------------------
Task ID : 7, AVG ACC 1 : 86.771, AVG ACC 5 : 98.157
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task8_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 1, Val loss : 0.467, ACC@1 : 87.500, ACC@5 : 99.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.59it/s]
Task ID : 2, Val loss : 0.665, ACC@1 : 81.300, ACC@5 : 96.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 3, Val loss : 0.483, ACC@1 : 86.600, ACC@5 : 98.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 4, Val loss : 0.479, ACC@1 : 88.400, ACC@5 : 96.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.58it/s]
Task ID : 5, Val loss : 0.457, ACC@1 : 88.200, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.59it/s]
Task ID : 6, Val loss : 0.492, ACC@1 : 83.400, ACC@5 : 98.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 7, Val loss : 0.492, ACC@1 : 86.300, ACC@5 : 98.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.57it/s]
Task ID : 8, Val loss : 0.508, ACC@1 : 86.700, ACC@5 : 98.100
--------------------------------------------------------------------------------
Task ID : 8, AVG ACC 1 : 86.050, AVG ACC 5 : 98.013
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task9_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 1, Val loss : 0.492, ACC@1 : 87.600, ACC@5 : 98.600
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.55it/s]
Task ID : 2, Val loss : 0.708, ACC@1 : 80.200, ACC@5 : 96.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.62it/s]
Task ID : 3, Val loss : 0.497, ACC@1 : 87.100, ACC@5 : 98.200
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.61it/s]
Task ID : 4, Val loss : 0.510, ACC@1 : 88.100, ACC@5 : 96.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.57it/s]
Task ID : 5, Val loss : 0.506, ACC@1 : 87.600, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.58it/s]
Task ID : 6, Val loss : 0.512, ACC@1 : 83.000, ACC@5 : 98.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.60it/s]
Task ID : 7, Val loss : 0.532, ACC@1 : 86.100, ACC@5 : 97.000
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.56it/s]
Task ID : 8, Val loss : 0.529, ACC@1 : 86.000, ACC@5 : 97.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.56it/s]
Task ID : 9, Val loss : 0.276, ACC@1 : 92.100, ACC@5 : 99.400
--------------------------------------------------------------------------------
Task ID : 9, AVG ACC 1 : 86.422, AVG ACC 5 : 97.867
--------------------------------------------------------------------------------

Loading checkpoint from: ./output/checkpoint/task10_checkpoint.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.59it/s]
Task ID : 1, Val loss : 0.500, ACC@1 : 85.700, ACC@5 : 98.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.54it/s]
Task ID : 2, Val loss : 0.747, ACC@1 : 78.800, ACC@5 : 95.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.56it/s]
Task ID : 3, Val loss : 0.487, ACC@1 : 87.100, ACC@5 : 98.100
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.55it/s]
Task ID : 4, Val loss : 0.557, ACC@1 : 85.600, ACC@5 : 96.800
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.55it/s]
Task ID : 5, Val loss : 0.558, ACC@1 : 85.400, ACC@5 : 97.300
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.55it/s]
Task ID : 6, Val loss : 0.556, ACC@1 : 82.400, ACC@5 : 98.500
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.58it/s]
Task ID : 7, Val loss : 0.545, ACC@1 : 84.600, ACC@5 : 96.900
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.55it/s]
Task ID : 8, Val loss : 0.574, ACC@1 : 84.500, ACC@5 : 97.700
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.58it/s]
Task ID : 9, Val loss : 0.341, ACC@1 : 89.800, ACC@5 : 99.400
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:05<00:00,  7.60it/s]
Task ID : 10, Val loss : 0.430, ACC@1 : 87.500, ACC@5 : 98.700
--------------------------------------------------------------------------------
Task ID : 10, AVG ACC 1 : 85.140, AVG ACC 5 : 97.760
--------------------------------------------------------------------------------

Total AVG ACC 1 : 89.721
Total AVG ACC 5 : 98.662
Total : forgetting : 6.478
  ```

## Result
### Split-CIFAR100
| Name | Acc@1 | Forgetting |
| --- | --- | --- |
| L2P | 89.066 | 6.344 |
| DualPrompt | 89.721 | 6.478 |

## License

This project is licensed under the MIT License. See [LICENSE](https://github.com/yunseokddi/CL_milestone_implement/blob/main/LICENSE) for more details

## Reference

- **Project structure**: [https://github.com/jfc43/informative-outlier-mining](https://github.com/jfc43/informative-outlier-mining)
- **L2P**
  - [Original code] [https://github.com/google-research/l2p](https://github.com/google-research/l2p)
    
  - [Pytorch version] [https://github.com/JH-LEE-KR/l2p-pytorch](https://github.com/JH-LEE-KR/l2p-pytorch)
  
- **DualPrompt**
  - [Original code] [https://github.com/google-research/l2p](https://github.com/google-research/l2p)
    
  - [Pytorch version] [https://github.com/JH-LEE-KR/dualprompt-pytorch](https://github.com/JH-LEE-KR/dualprompt-pytorch) 